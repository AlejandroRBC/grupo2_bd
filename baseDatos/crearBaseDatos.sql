-- ============================================================
-- 1) TABLAS (PostgreSQL)
-- ============================================================


CREATE TABLE persona (
  id            bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nombre        varchar(80)  NOT NULL,
  apellido      varchar(80)  NOT NULL,
  telefono      varchar(30),
  fechanaci     date,
  sexo          varchar(10),
  nacionalidad  varchar(60)
);

CREATE TABLE cliente (
  idcliente   bigint PRIMARY KEY REFERENCES persona(id),
  categoria   varchar(30) NOT NULL,
  email       varchar(100)
);

CREATE TABLE empleado (
  idempleado  bigint PRIMARY KEY REFERENCES persona(id),
  cargo       varchar(60),
  salario     numeric(12,2),
  turno       varchar(30)
);

CREATE TABLE hotel (
  idhotel     bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nombreh     varchar(120),
  direccion   varchar(200),
  telefonoh   varchar(30),
  categoria   smallint
);

CREATE TABLE habitacion (
  idhotel         bigint      NOT NULL REFERENCES hotel(idhotel),
  nrohabitacion   integer     NOT NULL,
  tipohabitacion  varchar(60),
  capacidad       smallint,
  estado          varchar(30),
  precio          numeric(12,2),
  nro_piso        smallint,
  CONSTRAINT pk_habitacion PRIMARY KEY (idhotel, nrohabitacion)
);

CREATE TABLE reserva (
  idreserva     bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  fecha_inicio  date,
  fecha_fin     date,
  costo_total   numeric(12,2),
  estado        varchar(30),
  idcliente     bigint REFERENCES cliente(idcliente)
);

CREATE TABLE detalle_reserva (
  idhotel        bigint   NOT NULL,
  nrohabitacion  integer  NOT NULL,
  idreserva      bigint   NOT NULL REFERENCES reserva(idreserva),
  CONSTRAINT pk_det_res PRIMARY KEY (idhotel, nrohabitacion, idreserva),
  CONSTRAINT fk_det_hab FOREIGN KEY (idhotel, nrohabitacion) 
    REFERENCES habitacion(idhotel, nrohabitacion)
);

CREATE TABLE registro_ingreso (
  idregistro    bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  fecha_entrada date,
  fecha_salida  date,
  hora_entrada  varchar(8),
  hora_salida   varchar(8),
  idreserva     bigint REFERENCES reserva(idreserva),
  idhotel       bigint,
  nrohabitacion integer,
  CONSTRAINT fk_reg_hab FOREIGN KEY (idhotel, nrohabitacion) 
    REFERENCES habitacion(idhotel, nrohabitacion)
);

CREATE TABLE registra (
  idcliente   bigint NOT NULL REFERENCES cliente(idcliente),
  idregistro  bigint NOT NULL REFERENCES registro_ingreso(idregistro),
  CONSTRAINT pk_registra PRIMARY KEY (idcliente, idregistro)
);

CREATE TABLE dano (
  iddano         bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  observaciones  varchar(2000),
  monto          numeric(12,2),
  idempleado     bigint REFERENCES empleado(idempleado),
  idregistro     bigint REFERENCES registro_ingreso(idregistro)
);

/* ============================================================
   5) DATOS  (PostgreSQL)
   Ejecuta esto después de crear las tablas/FKs.
   ============================================================ */

-- PERSONA (auto-ID para las primeras filas)
INSERT INTO persona (nombre, apellido, telefono, fechanaci, sexo, nacionalidad) VALUES
 ('Carlos','Ruiz','555-1004',DATE '1980-03-20','M','Chileno'),
 ('Sofía','Vargas','555-1005',DATE '1995-11-10','F','Argentina'),
 ('Diego','Ramírez','555-1006',DATE '1988-09-15','M','Ecuatoriano'),
 ('Lucía','Torres','555-1007',DATE '1993-02-25','F','Peruana'),
 ('Mateo','Jiménez','555-1008',DATE '1982-06-18','M','Mexicano'),
 ('Valentina','Navarro','555-1009',DATE '1998-12-30','F','Colombiana'),
 ('Andrés','Mendoza','555-1010',DATE '1987-04-04','M','Chileno'),
 ('Camila','Flores','555-1011',DATE '1991-10-14','F','Argentina'),
 ('Javier','Morales','555-1012',DATE '1979-08-08','M','Mexicano'),
 ('Fernanda','Rojas','555-1013',DATE '1989-03-11','F','Ecuatoriana'),
 ('Gabriel','Castro','555-1014',DATE '1994-07-21','M','Colombiano'),
 ('Isabella','López','555-1015',DATE '1996-01-17','F','Peruana'),
 ('Ricardo','Salazar','555-1016',DATE '1983-12-05','M','Ecuatoriano'),
 ('Paula','Ortega','555-1017',DATE '1997-09-19','F','Argentina'),
 ('Felipe','Martínez','555-1018',DATE '1986-06-06','M','Colombiano'),
 ('Elena','Guerrero','555-1019',DATE '1999-02-02','F','Chilena'),
 ('Tomás','Paredes','555-1020',DATE '1984-11-23','M','Mexicano');

INSERT INTO persona (id,nombre,apellido,telefono,fechanaci,sexo,nacionalidad) VALUES
 (1001,'Bruno','Acosta','555-3001',DATE '1988-04-11','M','Boliviano'),
 (1002,'Diana','Barrios','555-3002',DATE '1991-09-03','F','Boliviana'),
 (1003,'Sergio','Cabello','555-3003',DATE '1984-12-22','M','Peruano'),
 (1004,'Noelia','Duarte','555-3004',DATE '1993-07-19','F','Paraguaya'),
 (1005,'Hugo','Espinoza','555-3005',DATE '1978-10-05','M','Chileno'),
 (1006,'Celia','Fierro','555-3006',DATE '1997-01-28','F','Argentina'),
 (1007,'Marco','Galindo','555-3007',DATE '1989-05-14','M','Boliviano'),
 (1008,'Patricia','Herrera','555-3008',DATE '1994-02-09','F','Colombiana'),
 (1009,'Iván','Ibarra','555-3009',DATE '1983-03-03','M','Ecuatoriano'),
 (1010,'Julia','Juárez','555-3010',DATE '1999-08-15','F','Mexicana'),
 (1011,'Kevin','Klein','555-3011',DATE '1987-06-12','M','Chileno'),
 (1012,'Laura','León','555-3012',DATE '1992-04-02','F','Peruana'),
 (1013,'Matías','Maldonado','555-3013',DATE '1985-11-27','M','Argentino'),
 (1014,'Nadia','Núñez','555-3014',DATE '1996-03-31','F','Boliviana'),
 (1015,'Oscar','Ojeda','555-3015',DATE '1981-01-19','M','Paraguayo'),
 (1016,'Pilar','Ponce','555-3016',DATE '1993-12-01','F','Colombiana'),
 (1017,'Quintín','Quiroga','555-3017',DATE '1990-07-07','M','Ecuatoriano'),
 (1018,'Rosa','Rivas','555-3018',DATE '1986-05-20','F','Peruana'),
 (1019,'Samuel','Saavedra','555-3019',DATE '1995-10-29','M','Boliviano'),
 (1020,'Tania','Tapia','555-3020',DATE '1998-09-23','F','Argentina'),
 (1021,'Ulises','Ugarte','555-3021',DATE '1982-02-02','M','Uruguayo'),
 (1022,'Violeta','Valdés','555-3022',DATE '1994-04-14','F','Chilena'),
 (1023,'Walter','Wong','555-3023',DATE '1980-08-08','M','Boliviano'),
 (1024,'Ximena','Xavier','555-3024',DATE '1991-06-26','F','Boliviana'),
 (1025,'Yago','Yáñez','555-3025',DATE '1988-12-12','M','Colombiano'),
 (1026,'Zoe','Zapata','555-3026',DATE '1997-07-30','F','Ecuatoriana'),
 (1027,'Adriana','Almeida','555-3027',DATE '1984-09-05','F','Peruana'),
 (1028,'Bernardo','Brito','555-3028',DATE '1986-03-03','M','Paraguayo'),
 (1029,'Carla','Camacho','555-3029',DATE '1993-01-15','F','Argentina'),
 (1030,'Diego','Delgado','555-3030',DATE '1985-04-04','M','Mexicano');

-- CLIENTE (referencia a persona.id)
INSERT INTO cliente (idcliente,categoria,email) VALUES
 (1,'VIP','ana@example.com'),
 (2,'Regular','luis@example.com'),
 (3,'Regular','maria@example.com'),
 (4,'VIP','carlos@example.com'),
 (5,'Regular','sofia@example.com'),
 (6,'Regular','diego@example.com'),
 (7,'VIP','lucia@example.com'),
 (8,'Regular','mateo@example.com'),
 (9,'Regular','valentina@example.com'),
 (10,'VIP','andres@example.com'),
 (1001,'Regular','bruno@demo.com'),
 (1002,'VIP','diana@demo.com'),
 (1003,'Regular','sergio@demo.com'),
 (1004,'Regular','noelia@demo.com'),
 (1005,'VIP','hugo@demo.com'),
 (1006,'Regular','celia@demo.com'),
 (1007,'Regular','marco@demo.com'),
 (1008,'VIP','patricia@demo.com'),
 (1009,'Regular','ivan@demo.com'),
 (1010,'Regular','julia@demo.com'),
 (1016,'Regular','pilar@demo.com'),
 (1018,'VIP','rosa@demo.com'),
 (1019,'Regular','samuel@demo.com'),
 (1020,'Regular','tania@demo.com'),
 (1026,'VIP','zoe@demo.com');

-- EMPLEADO (referencia a persona.id)
INSERT INTO empleado (idempleado,cargo,salario,turno) VALUES
 (11,'Recepcionista',800,'Mañana'),
 (12,'Gerente',2000,'Completo'),
 (13,'Limpieza',700,'Tarde'),
 (14,'Cocinero',900,'Noche'),
 (15,'Seguridad',850,'Noche'),
 (1011,'Recepcionista',900,'Mañana'),
 (1012,'Conserje',850,'Tarde'),
 (1013,'Cocinero',1100,'Noche'),
 (1014,'Limpieza',780,'Mañana'),
 (1015,'Mantenimiento',1200,'Completo'),
 (1021,'Botones',700,'Mañana'),
 (1022,'Camarero',820,'Tarde'),
 (1023,'Seguridad',950,'Noche'),
 (1024,'Supervisor',1500,'Completo'),
 (1025,'Barista',780,'Mañana');

-- HOTEL (IDENTITY; IDs esperados 1..6 en una BD nueva)
INSERT INTO hotel (nombreh,direccion,telefonoh,categoria) VALUES
 ('Hotel Central','Av. Principal 123','555-2001',4),
 ('Hotel Playa','Calle del Mar 45','555-2002',5),
 ('Hotel Sierra','Camino Montaña 89','555-2003',3),
 ('Hotel Lago','Av. Laguna 50','555-2004',4),
 ('Hotel Andes','Av. Cordillera 10','555-4001',4),
 ('Hotel Oasis','Ruta 9 Km 23','555-4002',5);

-- HABITACION (usa el orden de columnas de la tabla)
INSERT INTO habitacion VALUES
 (1,101,'Simple',2,'DISPONIBLE',50,1),
 (1,102,'Doble',4,'DISPONIBLE',80,1),
 (1,103,'Suite',2,'OCUPADA',150,2),
 (1,104,'Doble',4,'MANTENIMIENTO',75,2),
 (1,105,'Simple',2,'DISPONIBLE',45,3),

 (2,201,'Simple',2,'DISPONIBLE',60,1),
 (2,202,'Doble',4,'DISPONIBLE',100,1),
 (2,203,'Suite',2,'OCUPADA',200,2),
 (2,204,'Doble',4,'DISPONIBLE',90,2),
 (2,205,'Simple',2,'DISPONIBLE',55,3),

 (3,301,'Simple',2,'DISPONIBLE',40,1),
 (3,302,'Doble',4,'OCUPADA',85,1),
 (3,303,'Suite',2,'DISPONIBLE',180,2),
 (3,304,'Doble',4,'DISPONIBLE',95,2),
 (3,305,'Simple',2,'MANTENIMIENTO',50,3),

 (4,401,'Simple',2,'DISPONIBLE',60,1),
 (4,402,'Doble',4,'DISPONIBLE',95,1),
 (4,403,'Suite',2,'DISPONIBLE',210,2),
 (4,404,'Doble',4,'DISPONIBLE',100,2),
 (4,405,'Simple',2,'MANTENIMIENTO',55,3),

 (5,501,'Simple',2,'DISPONIBLE',65,1),
 (5,502,'Doble',4,'DISPONIBLE',100,1),
 (5,503,'Suite',2,'DISPONIBLE',230,2),
 (5,504,'Doble',4,'DISPONIBLE',105,2),
 (5,505,'Simple',2,'MANTENIMIENTO',60,3),
 (5,506,'Doble',4,'DISPONIBLE',98,3),
 (5,507,'Suite',2,'OCUPADA',240,4),
 (5,508,'Simple',2,'DISPONIBLE',70,4),

 (6,601,'Simple',2,'DISPONIBLE',55,1),
 (6,602,'Doble',4,'DISPONIBLE',95,1),
 (6,603,'Suite',2,'DISPONIBLE',220,2),
 (6,604,'Doble',4,'DISPONIBLE',102,2),
 (6,605,'Simple',2,'DISPONIBLE',60,3),
 (6,606,'Doble',4,'OCUPADA',110,3),
 (6,607,'Suite',2,'DISPONIBLE',250,4),
 (6,608,'Simple',2,'MANTENIMIENTO',58,4);

-- RESERVA (fechas relativas: CURRENT_DATE +/- días)
INSERT INTO reserva (fecha_inicio,fecha_fin,costo_total,estado,idcliente) VALUES
 (CURRENT_DATE,   CURRENT_DATE+2, 160,'CONFIRMADA',1),
 (CURRENT_DATE+1, CURRENT_DATE+3, 300,'PENDIENTE',2),
 (CURRENT_DATE+2, CURRENT_DATE+5, 450,'CONFIRMADA',3),
 (CURRENT_DATE-3, CURRENT_DATE-1, 120,'CHECKOUT',4),
 (CURRENT_DATE+4, CURRENT_DATE+6,  90,'CANCELADA',5),
 (CURRENT_DATE,   CURRENT_DATE+1, 200,'CONFIRMADA',6),
 (CURRENT_DATE+3, CURRENT_DATE+4, 140,'PENDIENTE',7),
 (CURRENT_DATE-5, CURRENT_DATE-2, 300,'CHECKOUT',8),
 (CURRENT_DATE+2, CURRENT_DATE+7, 500,'CONFIRMADA',9),
 (CURRENT_DATE+10,CURRENT_DATE+12,110,'PENDIENTE',10),
 (CURRENT_DATE+1, CURRENT_DATE+2,  95,'CONFIRMADA',2),
 (CURRENT_DATE+5, CURRENT_DATE+7, 210,'PENDIENTE',5),
 (CURRENT_DATE+8, CURRENT_DATE+10,100,'CONFIRMADA',7),
 (CURRENT_DATE-2, CURRENT_DATE,     60,'CHECKOUT',9),

 (CURRENT_DATE+2,  CURRENT_DATE+4, 180,'CONFIRMADA',1001),
 (CURRENT_DATE+3,  CURRENT_DATE+5, 210,'PENDIENTE',1002),
 (CURRENT_DATE-7,  CURRENT_DATE-5, 320,'CHECKOUT',1003),
 (CURRENT_DATE+6,  CURRENT_DATE+8, 150,'CONFIRMADA',1004),
 (CURRENT_DATE+10, CURRENT_DATE+13,480,'CONFIRMADA',1005),
 (CURRENT_DATE-2,  CURRENT_DATE+1, 220,'CHECKIN',1006),
 (CURRENT_DATE+1,  CURRENT_DATE+1,  90,'CANCELADA',1007),
 (CURRENT_DATE+4,  CURRENT_DATE+9, 560,'CONFIRMADA',1008),
 (CURRENT_DATE,    CURRENT_DATE+2, 200,'PENDIENTE',1009),
 (CURRENT_DATE+12, CURRENT_DATE+14, 95,'CONFIRMADA',1010),

 (CURRENT_DATE-1,  CURRENT_DATE+2, 260,'CHECKIN',1016),
 (CURRENT_DATE+5,  CURRENT_DATE+6, 120,'PENDIENTE',1018),
 (CURRENT_DATE-10, CURRENT_DATE-8, 390,'CHECKOUT',1019),
 (CURRENT_DATE+7,  CURRENT_DATE+9, 175,'CONFIRMADA',1020),
 (CURRENT_DATE+11, CURRENT_DATE+12, 88,'CONFIRMADA',1026),
 (CURRENT_DATE,    CURRENT_DATE+1, 130,'CONFIRMADA',2),
 (CURRENT_DATE-3,  CURRENT_DATE-1, 210,'CHECKOUT',5),
 (CURRENT_DATE+14, CURRENT_DATE+16,600,'CONFIRMADA',7),
 (CURRENT_DATE+2,  CURRENT_DATE+3, 110,'PENDIENTE',9),
 (CURRENT_DATE+9,  CURRENT_DATE+11,240,'CONFIRMADA',10);

-- DETALLE_RESERVA
INSERT INTO detalle_reserva VALUES
 (1,101,1),(1,103,2),(2,202,3),(2,203,4),(3,302,5),(3,303,6),
 (1,104,7),(2,201,8),(3,301,9),(2,205,10),(4,401,11),(4,403,12),
 (4,402,13),(4,404,14),
 (4,401,15),(4,402,15),(4,403,16),(4,404,16),(4,401,17),(4,403,18),
 (5,501,19),(5,503,19),(5,506,20),(5,507,20),(5,502,21),(5,505,22),
 (6,601,23),(6,603,23),(6,604,24),(6,606,24),(6,607,25),(6,602,26),
 (2,202,27),(2,204,27),(3,303,28),(1,104,29),(1,105,29),(3,304,30),
 (5,508,31),(5,506,31),(6,605,32),(6,607,32),(4,402,33),(4,404,33),
 (2,205,34),(2,201,34);

-- REGISTRO_INGRESO (IDENTITY; IDs esperados 1..N en BD nueva)
INSERT INTO registro_ingreso (fecha_entrada,fecha_salida,hora_entrada,hora_salida,idreserva,idhotel,nrohabitacion) VALUES
 (CURRENT_DATE-3,CURRENT_DATE-1,'14:00:00','10:00:00',4,2,203),
 (CURRENT_DATE-5,CURRENT_DATE-2,'15:00:00','09:00:00',8,2,201),
 (CURRENT_DATE,  CURRENT_DATE+1,'12:00:00','11:00:00',6,3,303),
 (CURRENT_DATE+2,CURRENT_DATE+3,'13:00:00','11:00:00',7,1,104),
 (CURRENT_DATE-1,CURRENT_DATE,  '11:00:00','10:30:00',1,1,101),
 (CURRENT_DATE-1,CURRENT_DATE+1,'14:10:00','10:15:00',15,4,401),
 (CURRENT_DATE-6,CURRENT_DATE-5,'12:30:00','10:00:00',17,4,401),
 (CURRENT_DATE,  CURRENT_DATE+2,'11:00:00','09:30:00',18,4,403),
 (CURRENT_DATE+1,CURRENT_DATE+2,'13:00:00','10:45:00',19,5,501),
 (CURRENT_DATE+1,CURRENT_DATE+3,'16:00:00','11:10:00',20,5,507),
 (CURRENT_DATE+2,CURRENT_DATE+4,'12:15:00','10:20:00',21,5,502),
 (CURRENT_DATE+6,CURRENT_DATE+7,'10:30:00','09:50:00',22,5,505),
 (CURRENT_DATE+3,CURRENT_DATE+4,'13:40:00','11:05:00',23,6,601),
 (CURRENT_DATE+5,CURRENT_DATE+6,'14:20:00','10:40:00',24,6,606),
 (CURRENT_DATE,  CURRENT_DATE+1,'12:00:00','11:10:00',25,6,607),
 (CURRENT_DATE+8,CURRENT_DATE+10,'12:50:00','10:10:00',26,6,602);

-- REGISTRA
INSERT INTO registra VALUES
 (4,1),(8,2),(6,3),(7,4),(1,5),
 (2,1),(3,1),(5,2),(9,3),(10,3),
 (2,4),(3,5),(8,5),(9,5),(10,5),
 (1001,6),(1002,6),(1003,7),(1004,8),(1005,9),
 (1006,10),(1007,10),(1008,11),(1009,11),(1010,12),
 (1016,12),(1018,13),(1019,13),(1020,14),(1026,14),
 (1,15),(2,15),(3,15),(4,15),(5,15);

-- DANO (IDENTITY para iddano)
INSERT INTO dano (observaciones,monto,idempleado,idregistro) VALUES
 ('Rotura de lámpara',50,13,1),
 ('Mancha en alfombra',80,14,2),
 ('Golpe en cabecera',65,12,3),
 ('Televisor sin señal',30,1011,6),
 ('Taza rota',15,1012,7),
 ('Sábanas manchadas',40,1013,9),
 ('Puerta desajustada',70,1014,10),
 ('Control remoto perdido',25,1015,11),
 ('Luz del baño quemada',10,1021,12),
 ('Mancha en cortina',22,1022,13),
 ('Daño en minibar',55,1023,14);
